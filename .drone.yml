---
kind: pipeline
name: deploy

clone:

steps:
  - name: deploy_schemas
    image: debian:stable-slim
    commands:
      - apt update && apt install -y rclone openssh-client
      - mkdir -p ~/.ssh
      - eval $(ssh-agent -s)
      - echo -e "Host *\n\tStrictHostKeyChecking no\n\n" > ~/.ssh/config
      - echo "$schema_key" > ~/.ssh/id_rsa
      - chmod 600 ~/.ssh/id_rsa
      - ssh-add
      - rclone sync . $schema_host:$schema_target -v --include "*.xsd" --rc-user $schema_user --dry-run

trigger:
  branch:
    - master
  event:
    - push

---
kind: signature
hmac: 8d17b4ffdfa075766495ca18b98c6a138bcd9216e57b77b2503c0a29e4a5df5c

...
